$(document).ready(function () {
  currentPage = "1";
  currentCover = 1;
  // changePage = (derection) => {
  //   if (derection == "up") {
  //     if (currentPage == "1") {
  //       return;
  //     }
  //   } else if (derection == "down") {
  //     // if (derection == "p-1") {
  //     //   return;
  //     // }
  //     currentActivePage = document.querySelector(".active-page");
  //     currentIndex = Number(currentActivePage.getAttribute("pageIndex")) + 1;
  //     currentActivePage.classList.remove("active-page");
  //     console.log(currentActivePage);
  //     var selector = '[pageIndex="' + currentIndex + '"]';
  //     targetPage = document.querySelector(selector);
  //     if (targetPage) {
  //       targetPage.classList.add("active-page");
  //     }
  //   }
  // };

  changePage = (elementTarget) => {
    //Đổi nút
    document.querySelector(".active-nav").classList.remove("active-nav");
    elementTarget.classList.add("active-nav");
    //Đổi trang

    currentPage = document.querySelector(".active-page");
    index = elementTarget.getAttribute("value");
    var selector = '[index="' + index + '"]';
    targetPage = document.querySelector(selector);
    if (targetPage == currentPage) {
      return;
    } else {
      currentPage.classList.remove("active-page");
    }

    targetPage.classList.add("active-page");
    resetAos();
  };

  resetAos = () => {
    console.log("reset AOS");
    elementHasRefrestAos = document.querySelectorAll(".aos-animate");
    elementHasRefrestAos.forEach((aos) => {
      aos.classList.remove("aos-animate");
    });

    setTimeout(() => {
      AOS.init();
      AOS.refreshHard();
    }, 300);
  };

  changeCover = (derection) => {
    if (derection == "up") {
      if (currentCover == 1) {
        return;
      } else {
        coverContainer = document.querySelector(".cover-container");
        coverContainer.classList.remove("cover-down");
        coverContainer.classList.add("cover-up");
        currentCover = 1;
      }
    } else if (derection == "down") {
      if (currentCover == 2) {
        myContainer = document.querySelector(".my_container");
        myContainer.classList.remove("is-cover");
        myContainer.classList.add("is-content");
        isCover = false;
        resetAos();
      } else {
        coverContainer = document.querySelector(".cover-container");
        coverContainer.classList.remove("cover-up");
        coverContainer.classList.add("cover-down");
        currentCover = 2;
      }
    }
  };

  isCover = true;
  canScroll = true;

  function handleMouseWheel(event) {
    if (event.deltaY > 0) {
      // Scrolling down
      if (canScroll) {
        console.log("Mouse wheel scrolled down");
        canScroll = false;
        //logic here
        if (isCover) {
          changeCover("down");
        } else {
          // changePage("down");
        }

        setTimeout(() => {
          canScroll = true;
        }, 500);
      }
    } else {
      // Scrolling up
      if (canScroll) {
        console.log("Mouse wheel scrolled up");
        canScroll = false;
        //logic here

        if (isCover) {
          changeCover("up");
        } else {
          // changePage("up");
        }

        setTimeout(() => {
          canScroll = true;
        }, 500);
      }
    }
  }

  // Attaching mouse wheel event listener to window
  window.addEventListener("wheel", handleMouseWheel);

  listNav = document.querySelectorAll(".nav-item");
  listNav.forEach((element) => {
    element.addEventListener("click", () => {
      changePage(event.currentTarget);
    });
  });

  //toHome
  document.querySelector(".to-home").addEventListener("click", () => {
    changeCover("up");
    setTimeout(() => {
      myContainer = document.querySelector(".my_container");
      myContainer.classList.add("is-cover");
      myContainer.classList.remove("is-content");
      isCover = true;
    }, 200);

    // resetAos();
  });

  setTimeout(() => {
    document.querySelector(".my_container").classList.add("un-hide");
  }, 200);

  var swiper = new Swiper(".mySwiper", {
    loop: true,
    spaceBetween: 10,
    slidesPerView: 3,
    freeMode: true,
    watchSlidesProgress: true,
    navigation: {
      nextEl: ".swiper-button-next-2",
      prevEl: ".swiper-button-prev-2",
    },
  });
  var swiper2 = new Swiper(".mySwiper2", {
    loop: true,
    spaceBetween: 10,
    navigation: {
      nextEl: ".page-4 .swiper-button-next",
      prevEl: ".page-4 .swiper-button-prev",
    },
    thumbs: {
      swiper: swiper,
    },
  });

  var swiper3 = new Swiper(".mySwiper3", {
    effect: "coverflow",
    grabCursor: true,
    centeredSlides: true,
    spaceBetween: 70,
    slidesPerView: 1,
    loop: true,
    coverflowEffect: {
      rotate: 0,
      stretch: 0,
      depth: 150,
      modifier: 1,
      slideShadows: true,
    },
    navigation: {
      nextEl: ".page-1 .swiper-button-next",
      prevEl: ".page-1 .swiper-button-prev",
    },
    pagination: {
      el: ".page-1 .swiper-pagination",
      type: "fraction",
    },
  });

  btnPlay = document.querySelector(".btn-play");
  btnPlay.addEventListener("click", () => {
    scriptImg = document.querySelector(".script-img");
    scriptImg.classList.add("d-none");
    imgThum = document.querySelector(".img-thum");
    imgThum.classList.add("d-none");
    // btnPlay.classList.add("d-none");
    videoContainer = document.querySelector(".video-container");
    videoContainer.classList.remove("d-none");
    // xử lí reload và play tại đây
    document.querySelector("video").play();
  });
});

// write function convert string to number

// write function change background when click on button has id = "haha"
